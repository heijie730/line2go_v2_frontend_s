<div class="container">
  <div class="row border-bottom"
       style="padding-bottom: 0.8rem;text-align: center;
       padding-top: 1rem!important; position: sticky;top: 0;background-color: white;z-index: 1000">
    <div class="col-2">
      <i class="bi bi-chevron-left" [routerLink]="['/leader/home']"></i>
    </div>
    <div class="col-1">
    </div>
    <div class="col text-center">
<!--      <div class="date-link" data-bs-toggle="modal" data-bs-target="#calendarBackdrop">-->
<!--        {{date}}-->
<!--      </div>-->
<!--      <input  #datePicker id="datePicker" class="form-control" style="background-color: #e9ecef;" type="text" [(ngModel)]="date"/>-->
      <div #datePicker id="datePicker" class="date-link" >
        {{date}}
      </div>
    </div>
    <div class="col-1">
      <app-notification-icon [homeUrl]="router.url"></app-notification-icon>
    </div>
    <div class="col-2">
      <div class="dropdown">
        <a style="padding: revert;" data-bs-toggle="dropdown"
           aria-expanded="false">
          <i class="bi bi-plus-lg"></i>
        </a>
        <div class="dropdown-menu dropdown-menu-dark text-small shadow">
          <li><a class="dropdown-item" [routerLink]="['/leader/leader-scan']">Scan</a></li>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade nav-tab-padding-bottom" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab"
           tabindex="0">
        <div *ngIf="queue" class="text-center" style="padding-top: 1rem!important;">
          <h4 class="text-center">{{queue.queueName}}</h4>
        </div>
        <div class="text-center">
          <qrcode *ngIf="queueUpUrl" [qrdata]="queueUpUrl"
                  [elementType]="'img'"
                  [width]="256" [errorCorrectionLevel]="'M'"></qrcode>
        </div>
        <div class="text-center">
          <h6 class="text-center">Scan to Get Ticket</h6>
        </div>
        <div class="d-flex mt-2">
          <input class="form-control" [(ngModel)]="queueUpUrl" readonly>
          <button class="btn  ms-2" (click)="copyUrl()">
            <i *ngIf="!copyChecked" class="bi bi-clipboard"></i>
            <i *ngIf="copyChecked" class="bi bi-clipboard-check"></i>
          </button>
        </div>
      </div>
      <div class="tab-pane fade nav-tab-padding-bottom" id="nav-setting" role="tabpanel"
           aria-labelledby="nav-setting-tab" tabindex="0">
        <div class="list-group w-auto list-group-flush border-bottom">
          <a href="#" [routerLink]="['/leader/edit-base-info',queueId]"
             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
            <i class="fas fa-edit"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Edit Basic Information</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true"
             [routerLink]="['/leader/tag-list',queueId]">
            <i class="fas fa-tags"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Tags</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true"
             [routerLink]="['/leader/tag-rules',queueId]">
            <i class="fas fa-book"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Tag Rules</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true"
             [routerLink]="['/leader/action-management',queueId]">
            <i class="fas fa-cog"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Action Management</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" [routerLink]="['/leader/survey-list',queueId]" [queryParams]="{ page: 0, size: 10}"
             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
            <i class="fas fa-poll"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Survey List</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

<!--          <a href="#" [routerLink]="['/leader/queue-notification',queueId]"-->
<!--             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">-->
<!--            <i class="fas fa-mobile-alt"></i>-->
<!--            <div class="d-flex gap-2 w-100 justify-content-between">-->
<!--              <div>-->
<!--                <h6 class="mb-0">Notification Management</h6>-->
<!--              </div>-->
<!--              <small class="opacity-50 text-nowrap">-->
<!--                <i class="bi bi-chevron-compact-right"></i>-->
<!--              </small>-->
<!--            </div>-->
<!--          </a>-->

          <a href="#" [routerLink]="['/leader/service-time-manager',queueId]"
             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
            <i class="far fa-clock"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Service Time Settings</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" [routerLink]="['/leader/child-queue-manager',queueId]"
             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
            <i class="fas fa-sitemap"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Child Queue Management</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" [routerLink]="['/leader/member-options',queueId]"
             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
            <i class="fa fa-user"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Member Options</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" [routerLink]="['/leader/dashboard-manager',queueId]"
             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
            <i class="fas fa-tv"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Dashboard Management</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>

          <a href="#" [routerLink]="['/leader/board-cast-manager',queueId]"
             class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
            <i class="fas fa-broadcast-tower"></i>
            <div class="d-flex gap-2 w-100 justify-content-between">
              <div>
                <h6 class="mb-0">Broadcast Message Management</h6>
              </div>
              <small class="opacity-50 text-nowrap">
                <i class="bi bi-chevron-compact-right"></i>
              </small>
            </div>
          </a>
        </div>
      </div>
      <div class="tab-pane fade nav-tab-padding-bottom" id="nav-contact" role="tabpanel"
           aria-labelledby="nav-contact-tab"
           tabindex="0">
        <div class="card">
          <div class="card-header">
            <div class="row">
              <div class="col">
                Tickets
              </div>
              <div class="col-2">
              </div>
              <div class="col-2">
                <div class="dropdown">
                  <a data-bs-toggle="dropdown"
                     aria-expanded="false"
                     data-bs-auto-close="outside">
                    <i class="bi bi-funnel" *ngIf="filterTags.length==0"></i>
                    <i class="bi bi-funnel-fill" *ngIf="filterTags.length>0"></i>
                  </a>
                  <div class="dropdown-menu text-small shadow ">
                    <div class="form-control" style="border-top: unset;">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="tagOption" id="flexRadioDefault1"
                               [(ngModel)]="filterTagOption" value="INCLUDE" (ngModelChange)="includeTagsChange()">
                        <label class="form-check-label" for="flexRadioDefault1">
                          Include Tags
                        </label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="tagOption" id="flexRadioDefault2"
                               [(ngModel)]="filterTagOption" value="EXCLUDE" (ngModelChange)="includeTagsChange()">
                        <label class="form-check-label" for="flexRadioDefault2">
                          Exclude Tags
                        </label>
                      </div>
                    </div>
                    <label class="dropdown-item" *ngFor="let tagVo of filterTagVos;index as i">
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="include-filter-check-{{i}}"
                               [(ngModel)]="tagVo.checked" (ngModelChange)="includeTagsChange()">
                        <label class="form-check-label" for="include-filter-check-{{i}}">
                          {{tagVo.tagContent}}
                        </label>
                      </div>
                    </label>
                  </div>
                </div>
              </div>

              <div class="col-1">
                <div class="dropdown">
                  <a data-bs-toggle="dropdown"
                     aria-expanded="false"
                     data-bs-auto-close="outside">
                    <i class="bi bi-funnel" *ngIf="!filterText"></i>
                    <i class="bi bi-funnel-fill" *ngIf="filterText"></i>
                  </a>
                  <div class="dropdown-menu text-small shadow ">
                    <div class="p-2 mb-2 bg-light border-bottom">
                      <input type="search" [(ngModel)]="filterText"
                             (ngModelChange)="onFilterTextChange()"
                             class="form-control" autocomplete="false" placeholder="Search...">
                    </div>
                    <label class="dropdown-item" *ngFor="let searchOptionVo of searchOptionVoList;index as i">
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox"
                               id="filter-check-{{i}}" [(ngModel)]="searchOptionVo.checked"
                               (ngModelChange)="onChange()">
                        <label class="form-check-label" for="filter-check-{{i}}">
                          {{searchOptionVo.value}}
                        </label>
                      </div>
                    </label>
                  </div>
                </div>
              </div>
              <div class="col-2">
                <div class="dropdown position-absolute top-0 end-0" style="width: 1.9rem;padding-top: 0.4rem;">
                  <a style="padding: revert;" data-bs-toggle="dropdown"
                     aria-expanded="false">
                    <i class="bi bi-three-dots-vertical"></i>
                  </a>
                  <div class="dropdown-menu dropdown-menu-dark text-small shadow">
                    <a class="dropdown-item" data-bs-toggle="modal"
                       data-bs-target="#advanceModal">Advanced</a>
                    <a class="dropdown-item" (click)="selectAll()">Select All</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body" style="padding: 0.2rem;">
            <div class="d-grid gap-1" style="height: 18.6rem;">
              <div class="cal">
                <div class="cal-month">
                  <button class="btn cal-btn" type="button" (click)="toPage(page-1<0?0:page-1)">
                    <i class="bi bi-arrow-left-short"></i>
                  </button>
                  <strong class="cal-month-name">{{page + 1}}</strong>
                  <button class="btn cal-btn" type="button" (click)="toPage(page+1)">
                    <i class="bi bi-arrow-right-short"></i>
                  </button>
                </div>
                <div class="cal-days">
                  <div
                    class="form-check checkbox-parent"
                    [style.background-color]="ticketVo.tags.length>0?ticketVo.tags[ticketVo.tags.length-1].color:''"
                    *ngFor="let ticketVo of ticketVos" (click)="ticketClick(ticketVo)">
                    <input class="form-check-input" style="float: unset;margin-left: unset;"
                          [checked]="ticketVo.checked"
                           type="checkbox" id="checkbox{{ticketVo.id}}">
                    <div>
                      <label class="form-check-label" >
                        {{ticketVo.ticketNo}}
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="offcanvas offcanvas-bottom" tabindex="-1" data-bs-scroll="true" data-bs-backdrop="false"
             style="height: unset; padding-bottom: 1rem;"
             id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
          <div class="offcanvas-header">
            <div class="container">
              <div class="row text-break">
                <p>{{ getTicketNos() }}</p>
              </div>
            </div>

            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
          </div>
          <div style="text-align: center; overflow-y: unset;">
            <div class="container">
              <div class="row row-cols-4">
                <div class="col">
                  <ul class="dropdown-menu">
                    <li>
                      <a class="dropdown-item" (click)="printer()">Download Tickets</a>
                    </li>
                    <li>
                      <a class="dropdown-item" (click)="exportExcel()">Download Table</a>
                    </li>
                  </ul>
                  <div data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-download"></i>
                    <div style="font-size: xx-small;">Download</div>
                  </div>
                </div>

                <div class="col" data-bs-toggle="modal" data-bs-target="#ticketDetailModal">
                  <i class="bi bi-file-earmark-text"></i>
                  <div style="font-size: xx-small;">Details</div>
                </div>
                <div class="col">
                  <ul class="dropdown-menu">
                    <li *ngFor="let tagItem of tags">
                      <a class="dropdown-item" (click)="tagTicket(tagItem)">{{ tagItem.tagContent }}</a>
                    </li>
                    <li>
                      <hr class="dropdown-divider">
                    </li>
                    <li>
                      <a class="dropdown-item" [routerLink]="['/leader/tag-list', queueId]"><b>Edit</b></a>
                    </li>
                  </ul>
                  <div data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-tag"></i>
                    <div style="font-size: xx-small;">Tags</div>
                  </div>
                </div>
                <div class="col">
                  <ul class="dropdown-menu">
                    <li *ngFor="let informItem of informItems">
                      <a class="dropdown-item" (click)="inform(informItem)">{{ informItem.title }}</a>
                    </li>
                    <li>
                      <hr class="dropdown-divider">
                    </li>
                    <li>
                      <a class="dropdown-item" [routerLink]="['/leader/manual-inform', queueId]"><b>Edit</b></a>
                    </li>
                  </ul>
                  <div data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-send"></i>
                    <div style="font-size: xx-small;">Notifications</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <app-board-cast *ngIf="queue" [date]="date" [queueVo]="queue"
                        [role]="RoleEnum.LEADER"></app-board-cast>

        <div class="modal fade" id="advanceModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
             aria-labelledby="advanceModalLabel" aria-hidden="true" style="z-index: 1056">
          <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="advanceModalLabel">Generate Empty Ticket
                  <app-tool-tip [content]="'Empty tickets are those that have not been claimed by users yet. Tickets clearing rule: If the usage date is earlier than the current time, the tickets will be cleared 90 days after the current time. Otherwise, the tickets will be cleared 90 days after the usage date.'"></app-tool-tip>
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="input-group mb-3">
                  <select class="form-select" aria-label="Default select example"
                          [(ngModel)]="generateType"
                  >
                    <option value="BY_TICKET_COUNT">Generate by Quantity</option>
                    <option value="BY_TICKET_NO">Generate by Ticket Number</option>
                  </select>
                </div>

                <div class="input-group mb-3" *ngIf="generateType=='BY_TICKET_COUNT'">
                  <input type="number" class="form-control" [(ngModel)]="generateTicketNums"
                         placeholder="Enter Quantity" aria-label="Enter Quantity"
                         aria-describedby="button-addon2">
                  <button class="btn btn-outline-secondary" type="button" id="button-addon2"
                          (click)="generateTicketByCount()">
                    Generate
                  </button>
                </div>
                <div class="input-group mb-3" *ngIf="generateType=='BY_TICKET_NO'">
                  <input type="text" class="form-control" placeholder="Start Number" aria-label="Start Number"
                         [(ngModel)]="generateByTicketNo.startTicketNo">
                  <span class="input-group-text">-</span>
                  <input type="text" class="form-control" placeholder="End Number" aria-label="End Number"
                         [(ngModel)]="generateByTicketNo.endTicketNo">
                  <button class="btn btn-outline-secondary" type="button" id="button-addon3"
                          (click)="generateTicketByTicketNo()">
                    Generate
                  </button>
                </div>
                <div class="form-check form-switch">
                  <input *ngIf="queue" [checked]="queue.allowUserCreateTicket" (click)="onGenerateCheckChange($event)"
                         class="form-check-input" type="checkbox" role="switch"
                         id="flexSwitchCheckChecked" checked>
                  <label class="form-check-label">Automatically Generate Empty Tickets when Users Attempt to Claim but None Available
                    <app-tool-tip [direction]="'top'"
                                  [content]="'When this option is disabled and no empty tickets are available, users cannot claim a ticket. This option can be used to limit the number of available tickets'"></app-tool-tip>
                  </label>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>

      </div>


    </div>
  </div>
</div>
<nav id="navTab" class="container" style="position: fixed;bottom: 0;background-color: white;left: 50%;
    transform: translate(-50%,0%);">
  <div class="nav nav-pills row row-cols" id="nav-tab" role="tablist">
    <button class="nav-link col" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button"
            role="tab" aria-controls="nav-home" aria-selected="false">
      <i class="bi bi-qr-code-scan"></i>
      <div style="font-size: xx-small;">Scan</div>
    </button>
    <button class="nav-link col" id="nav-setting-tab" data-bs-toggle="tab" data-bs-target="#nav-setting"
            type="button"
            role="tab" aria-controls="nav-setting" aria-selected="false">
      <i class="bi bi-gear"></i>
      <div style="font-size: xx-small;">Settings</div>
    </button>
    <button class="nav-link col" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-contact"
            type="button"
            role="tab" aria-controls="nav-contact" aria-selected="true">
      <i class="bi bi-send"></i>
      <div style="font-size: xx-small;">Send</div>
    </button>
  </div>
</nav>

<!--<app-calendar *ngIf="queue" [id]="'calendarBackdrop'" [dateStr]="date" [queueVo]="queue"-->
<!--              (afterDateChecked)="afterDateChecked($event)"></app-calendar>-->
<app-ticket-detail-modal [id]="'ticketDetailModal'"
                         [ticketVos]="allCheckedTickets"
                         (triggerDeleteTag)="triggerDeleteTag($event)"
                         (triggerDeleteTickets)="deleteTickets($event)"
>

</app-ticket-detail-modal>

